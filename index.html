<!doctype html>
<html lang="zh-CN">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Minimalist Search & Calculator">
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Ccircle cx='58' cy='58' r='28' fill='none' stroke='%230f172a' stroke-width='10'/%3E%3Cpath d='M78 78l22 22' stroke='%230f172a' stroke-width='10' stroke-linecap='round'/%3E%3C/svg%3E">
  <title>Search</title>
  <style>
    :root {
      --font-size: clamp(28px, 4vw + 1vh, 72px);
      --container-width: 1000px;
      --flash-color: #1a1a1a
    }

    body {
      --bg: #ffffff;
      --text: #1a1a1a;
      --caret-color: #1a1a1a;
      --ghost: #a0a0a0;
      --glow: rgba(0, 0, 0, 0.05);
      margin: 0;
      min-height: 100dvh;
      min-width: 320px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      padding-top: 32vh;
      background: var(--bg);
      font-family: "Menlo", "Monaco", "Consolas", "Courier New", "PingFang SC", "Microsoft YaHei UI", "Microsoft YaHei", monospace;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow: hidden;
      opacity: 1;
      transform: scale(1);
      transition: background .5s ease, opacity .4s ease, transform .4s cubic-bezier(0.2, 0, 0, 1)
    }

    body.dark {
      --bg: #09090b;
      --text: #f0f0f0;
      --caret-color: #f0f0f0;
      --ghost: #555555;
      --glow: rgba(255, 255, 255, 0.15)
    }

    * {
      box-sizing: border-box
    }

    body.departing {
      opacity: 0;
      transform: scale(0.96);
      pointer-events: none
    }

    form {
      width: 100%;
      display: flex;
      justify-content: center;
      z-index: 1
    }

    .input-wrapper {
      position: relative;
      width: min(90vw, var(--container-width));
      height: clamp(120px, 18vw, 160px);
      display: flex;
      align-items: center;
      overflow: hidden;
      font-size: var(--font-size);
      transform-origin: center;
      transition: transform .05s ease-out
    }

    .recoil {
      transform: scale(0.995)
    }

    .typo {
      font-family: inherit;
      font-size: inherit;
      line-height: normal;
      letter-spacing: 0;
      font-variant-ligatures: none;
      font-weight: 500;
      margin: 0;
      padding: 0;
      border: 0;
      text-shadow: 0 0 30px var(--glow);
      transition: text-shadow .3s ease
    }

    input[type="text"] {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      color: var(--text);
      outline: none;
      caret-color: transparent;
      z-index: 2;
      padding: 0;
      padding-right: 60px
    }

    .idle-caret {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translate(0, -50%) scale(1);
      width: 16px;
      height: 1.1em;
      background: var(--caret-color);
      pointer-events: none;
      z-index: 3;
      border-radius: 0;
      transform-origin: left center;
      transition: transform .1s cubic-bezier(0.25, 1.5, 0.5, 1), background-color .2s, opacity .5s ease;
      will-change: transform;
      box-shadow: 0 0 20px var(--glow)
    }

    .ghost-text {
      position: absolute;
      left: 0;
      top: 50%;
      transform: translate(0, -50%);
      color: var(--ghost);
      pointer-events: none;
      white-space: pre;
      z-index: 1;
      transition: transform .1s cubic-bezier(0.25, 1.5, 0.5, 1);
      font-style: italic;
      opacity: 0.6
    }

    .measure {
      position: absolute;
      visibility: hidden;
      white-space: pre;
      pointer-events: none;
      top: 0;
      left: 0
    }

    @media (min-width:1440px) {
      :root {
        --font-size: clamp(36px, 3.5vw, 80px);
        --container-width: 1200px
      }

      .idle-caret {
        width: 18px
      }
    }

    @media (max-width:1439px) and (min-width:1025px) {
      :root {
        --font-size: clamp(28px, 4vw + 0.5vh, 68px)
      }

      body {
        padding-top: 30vh
      }
    }

    @media (max-width:1024px) {
      :root {
        --font-size: clamp(24px, 4.5vw + 0.5vh, 64px)
      }

      body {
        padding-top: 26vh
      }

      .input-wrapper {
        height: clamp(100px, 18vw, 140px)
      }

      .idle-caret {
        width: 14px
      }
    }

    @media (max-width:767px) and (min-width:641px) {
      :root {
        --font-size: clamp(22px, 5.5vw + 0.5vh, 56px)
      }

      body {
        padding-top: 24vh;
        padding-inline: 20px
      }

      .input-wrapper {
        height: clamp(90px, 16vw, 130px);
        width: 100%
      }
    }

    @media (max-width:640px) {
      :root {
        --font-size: clamp(20px, 7vw + 0.5vh, 52px)
      }

      body {
        padding-top: 20vh;
        padding-inline: 16px
      }

      .input-wrapper {
        height: clamp(80px, 20vw, 120px);
        width: 100%
      }

      .idle-caret {
        width: 12px
      }

      input[type="text"] {
        padding-right: 40px
      }
    }

    @media (max-width:479px) {
      :root {
        --font-size: clamp(18px, 8vw, 44px)
      }

      body {
        padding-top: 18vh;
        padding-inline: 12px
      }

      .input-wrapper {
        height: clamp(70px, 22vw, 100px)
      }

      .idle-caret {
        width: 10px;
        height: 1em
      }

      input[type="text"] {
        padding-right: 30px
      }
    }

    @media (max-width:319px) {
      :root {
        --font-size: 16px
      }

      body {
        min-width: 280px;
        padding-top: 15vh;
        padding-inline: 8px
      }

      .input-wrapper {
        height: 60px
      }

      .idle-caret {
        width: 8px
      }
    }

    @media (max-height:540px) and (orientation:landscape) {
      body {
        padding-top: 14vh
      }

      .input-wrapper {
        height: clamp(60px, 18vh, 100px)
      }

      :root {
        --font-size: clamp(20px, 8vh, 48px)
      }
    }

    @media (max-height:400px) {
      body {
        padding-top: 10vh
      }

      .input-wrapper {
        height: clamp(50px, 15vh, 80px)
      }

      :root {
        --font-size: clamp(16px, 6vh, 36px)
      }
    }

    @media (hover:none) and (pointer:coarse) {
      .input-wrapper {
        min-height: 60px
      }

      input[type="text"] {
        font-size: max(16px, var(--font-size))
      }

      .idle-caret {
        transition: transform .05s ease-out, background-color .2s
      }
    }

    @media (-webkit-min-device-pixel-ratio:2),
    (min-resolution:192dpi) {
      .idle-caret {
        box-shadow: 0 0 25px var(--glow)
      }
    }

    @media (min-width:2560px) {
      :root {
        --font-size: clamp(48px, 2.5vw, 96px);
        --container-width: 1600px
      }

      .idle-caret {
        width: 24px
      }

      body {
        padding-top: 35vh
      }

      .input-wrapper {
        height: clamp(160px, 12vw, 220px)
      }
    }

    @media (prefers-color-scheme:dark) {
      body:not(.light-forced) {
        --bg: #09090b;
        --text: #f0f0f0;
        --caret-color: #f0f0f0;
        --ghost: #555555;
        --glow: rgba(255, 255, 255, 0.15)
      }
    }

    @media (prefers-reduced-motion:reduce) {

      *,
      *::before,
      *::after {
        animation-duration: .01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: .01ms !important
      }

      .idle-caret {
        transition: none
      }

      body {
        transition: background .01ms
      }
    }

    @media (prefers-contrast:high) {
      :root {
        --ghost: #666666
      }

      body {
        --text: #000000;
        --caret-color: #000000
      }

      body.dark {
        --text: #ffffff;
        --caret-color: #ffffff;
        --ghost: #999999
      }

      .idle-caret {
        box-shadow: none
      }
    }

    .blink {
      animation: blink 1s steps(1) infinite
    }

    @keyframes blink {

      0%,
      100% {
        opacity: 1
      }

      50% {
        opacity: 0
      }
    }

    .flash-brand {
      animation: flash-color .5s ease forwards
    }

    @keyframes flash-color {
      0% {
        background: var(--caret-color);
        transform: translate(0, -50%) scale(1)
      }

      30% {
        background: var(--flash-color);
        box-shadow: 0 0 50px var(--flash-color);
        transform: translate(0, -50%) scale(1.4, 0.8)
      }

      100% {
        background: var(--caret-color);
        transform: translate(0, -50%) scale(1)
      }
    }

    .shake {
      animation: shake .4s cubic-bezier(.36, .07, .19, .97) both
    }

    @keyframes shake {

      10%,
      90% {
        transform: translate3d(-1px, 0, 0)
      }

      20%,
      80% {
        transform: translate3d(2px, 0, 0)
      }

      30%,
      50%,
      70% {
        transform: translate3d(-3px, 0, 0)
      }

      40%,
      60% {
        transform: translate3d(3px, 0, 0)
      }
    }
  </style>
</head>

<body>
  <form id="search-form" action="https://www.google.com/search" method="get" autocomplete="off">
    <div class="input-wrapper">
      <div id="measure" class="measure typo"></div>
      <div class="idle-caret"></div>
      <div id="ghost" class="ghost-text typo"></div>
      <input id="q" type="text" name="q" class="typo" autofocus autocomplete="off" aria-label="搜索">
    </div>
  </form>
  <script>
    const e = { g: { action: 'https://www.google.com/search', param: 'q', color: '#4285F4' }, b: { action: 'https://www.baidu.com/s', param: 'wd', color: '#2932E1' }, bi: { action: 'https://www.bing.com/search', param: 'q', color: '#00809d' }, gh: { action: 'https://github.com/search', param: 'q', color: '#A371F7' }, v: { action: 'https://search.bilibili.com/all', param: 'keyword', color: '#FB7299' }, z: { action: 'https://www.zhihu.com/search', param: 'q', color: '#0084FF' }, y: { action: 'https://www.youtube.com/results', param: 'search_query', color: '#FF0000' } }, i = document.getElementById('q'), f = document.getElementById('search-form'), c = document.querySelector('.idle-caret'), m = document.getElementById('measure'), g = document.getElementById('ghost'), w = document.querySelector('.input-wrapper'), G = 15, lh = () => { try { return (JSON.parse(sessionStorage.getItem('searchHistory')) || []).map(t => "string" == typeof t ? t.trim() : "").filter(Boolean).filter((t, e, r) => 0 === e || r[e - 1] !== t) } catch { return [] } }; let h = lh(), hi = -1, ti = '', cr = null, bt = null, jt = null;
    const ss = () => { const t = window.getComputedStyle(i); m.style.font = t.font, m.style.letterSpacing = t.letterSpacing, m.style.fontVariantLigatures = t.fontVariantLigatures, m.style.lineHeight = t.lineHeight }, uu = () => { const t = i.value; m.textContent = t; const e = m.getBoundingClientRect().width, r = w.clientWidth, n = t.length ? G : 0, o = e + n - i.scrollLeft, a = Math.max(0, Math.min(o, r - 18)); c.style.transform = `translate(${a}px, -50%) scale(1.3, 0.85)`, null !== cr ? (g.textContent = `= ${cr}`, g.style.transform = `translate(${a + 25}px, -50%)`) : g.textContent = "", c.classList.remove("blink"), c.style.opacity = 1, clearTimeout(jt), jt = setTimeout(() => { c.style.transform = `translate(${a}px, -50%) scale(1, 1)` }, 100), clearTimeout(bt), bt = setTimeout(() => { c.classList.add("blink") }, 500) }, tk = t => { const e = []; let r = ""; const n = () => { if (r) { if (!/^\d*\.?\d+$/.test(r) && !/^\d+\.$/.test(r)) return !1; e.push(r), r = "" } return !0 }; for (const o of t) /\d/.test(o) || '.' === o ? ('.' === o && r.includes('.') || (r += o)) : /\s/.test(o) ? n() || 0 : '+-*/()'.includes(o) ? n() && (e.push(o), 1) : 0; return n() && e.length ? e : null }, tr = t => { const e = [], r = [], n = { "+": 1, "-": 1, "*": 2, "/": 2 }; let o = null; for (const a of t) { if (!isNaN(parseFloat(a))) { e.push(parseFloat(a)), o = "num"; continue } if ("(" === a) { r.push(a), o = "("; continue } if (")" === a) { for (; r.length && "(" !== r[r.length - 1];)e.push(r.pop()); if ("(" !== r.pop()) return null; o = ")"; continue } if ("+-*/".includes(a)) { if (("-" === a || "+" === a) && (null === o || "(" === o || "op" === o)) { if ("-" === a && e.push(0), "+" === a) continue } else { if ("op" === o) return null; if (null === o) return null } for (; r.length;) { const t = r[r.length - 1]; if ("(" === t || n[t] < n[a]) break; e.push(r.pop()) } r.push(a), o = "op"; continue } return null } for (; r.length;) { const t = r.pop(); if ("(" === t) return null; e.push(t) } return e }, er = t => { const e = []; for (const r of t) { if ("number" == typeof r) { e.push(r); continue } const n = e.pop(), o = e.pop(); if (void 0 === o || void 0 === n) return null; switch (r) { case "+": e.push(o + n); break; case "-": e.push(o - n); break; case "*": e.push(o * n); break; case "/": e.push(0 === n ? NaN : o / n); break; default: return null } } return 1 === e.length && isFinite(e[0]) ? e[0] : null }, tc = t => { if (!t || t.endsWith(" ")) return null; const r = t.trim(); if (!/[+\-*/]/.test(r)) return null; const n = tk(r); if (!n) return null; const o = tr(n); if (!o) return null; const a = er(o); if (null === a) return null; const s = (l = a, p = 12, parseFloat(l.toPrecision(p))); var l, p; const u = (d = s, Number.isInteger(d) ? d : parseFloat(d.toFixed(10))); var d; return String(u) === r ? null : u }, se = (t, r, n = !0) => { f.action = t.action, i.name = t.param, document.body.style.setProperty("--flash-color", t.color), i.value = "", i.scrollLeft = 0, n && r && localStorage.setItem("defaultSearchEngine", r), c.style.transition = "none", g.style.transition = "none", uu(), void c.offsetWidth, c.classList.remove("blink"), c.classList.remove("flash-brand"), void c.offsetWidth, c.classList.add("flash-brand"), setTimeout(() => { c.classList.remove("flash-brand"), c.style.transition = "transform 0.1s cubic-bezier(0.25, 1.5, 0.5, 1), background-color 0.2s, opacity 0.5s ease", g.style.transition = "transform 0.1s cubic-bezier(0.25, 1.5, 0.5, 1)", c.classList.add("blink") }, 500) }, tt = (t, e = !0) => { const r = "dark" === t; r ? (document.body.classList.add("dark"), document.body.classList.remove("light-forced")) : (document.body.classList.remove("dark"), document.body.classList.add("light-forced")), e && localStorage.setItem("theme", t), setTimeout(uu, 50) }, ts = () => { w.classList.remove("shake"), void w.offsetWidth, w.classList.add("shake") }, trc = () => { w.classList.remove("recoil"), void w.offsetWidth, w.classList.add("recoil"), setTimeout(() => w.classList.remove("recoil"), 50) }, iu = t => { const e = t.trim(); if (!e || /\s/.test(e)) return !1; const r = e.match(/^([a-z][a-z0-9+.-]*):\/\//i); if (r) { const t = r[1].toLowerCase(); return new Set(["http", "https", "ftp", "ftps"]).has(t) && !new Set(["javascript", "data", "vbscript", "file"]).has(t) } try { const t = new URL(e).protocol.replace(":", "").toLowerCase(); return new Set(["http", "https", "ftp", "ftps"]).has(t) && !new Set(["javascript", "data", "vbscript", "file"]).has(t) } catch { } const n = e.split("/"), o = n[0], a = /^(localhost|\d{1,3}(?:\.\d{1,3}){3}|[a-z0-9-]+(?:\.[a-z0-9-]+)+)(?::\d{2,5})?$/i; return !!a.test(o) && (!n.slice(1).length || !/\s/.test(n.slice(1).join("/"))) }; i.addEventListener("input", () => { cr = tc(i.value), hi = -1, trc(), uu() }), i.addEventListener("keydown", r => { if (" " === r.key) { const n = i.value; if (n.startsWith("/")) { const o = n.slice(1).toLowerCase(); if (e[o]) return r.preventDefault(), void se(e[o], o); if ("dark" === o) return r.preventDefault(), void tt("dark"); if ("light" === o) return r.preventDefault(), void tt("light") } } if ("Escape" === r.key) return i.value = "", hi = -1, void uu(); if ("Tab" === r.key && null !== cr && (r.preventDefault(), i.value = cr, cr = null, uu()), "ArrowUp" === r.key && (r.preventDefault(), h.length && (-1 === hi && (ti = i.value), hi = Math.min(hi + 1, h.length - 1), i.value = h[h.length - 1 - hi], uu())), "ArrowDown" === r.key && (r.preventDefault(), hi > -1 && (hi--, i.value = -1 === hi ? ti : h[h.length - 1 - hi], uu())), "Enter" === r.key) { const n = i.value.trim(); n.startsWith("/") && !n.includes(" ") && (r.preventDefault(), ts()) } }), f.addEventListener("submit", t => { const r = i.value.trim(); if (!r) return void t.preventDefault(); if (r.startsWith("/") && !r.includes(" ")) return t.preventDefault(), void ts(); h[h.length - 1] !== r && (h.push(r), h.length > 50 && h.shift(), sessionStorage.setItem("searchHistory", JSON.stringify(h))), t.preventDefault(), document.body.classList.add("departing"), setTimeout(() => { if (iu(r)) window.location.href = r.startsWith("http") ? r : "http://" + r; else { const t = i.name, n = f.action; window.location.href = `${n}?${t}=${encodeURIComponent(r)}` } }, 300) }), window.addEventListener("pageshow", () => { document.body.classList.remove("departing"), c.classList.add("blink") }), window.addEventListener("resize", () => { ss(), uu() }), i.addEventListener("scroll", uu), i.addEventListener("focus", uu), document.addEventListener("click", () => i.focus()), w.addEventListener("animationend", () => w.classList.remove("shake")); const se_ls = localStorage.getItem("defaultSearchEngine"); se_ls && e[se_ls] && (f.action = e[se_ls].action, i.name = e[se_ls].param); const st = localStorage.getItem("theme"); st && tt(st, !1); setTimeout(() => { ss(), uu() }, 10);
  </script>
</body>

</html>
